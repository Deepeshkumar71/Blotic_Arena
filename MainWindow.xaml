<Window x:Class="BloticArena.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Blotic Arena" 
        Height="750" 
        Width="1300"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource BackgroundBrush}"
        WindowStyle="None"
        AllowsTransparency="True"
        ResizeMode="CanResize">
    
    <Window.Resources>
        <!-- App Card Style -->
        <Style x:Key="AppCard" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource SurfaceBrush}"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="8"/>
            <Setter Property="BorderBrush" Value="#2A2F3E"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource HoverBrush}"/>
                    <Setter Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Border CornerRadius="12" Background="{StaticResource BackgroundBrush}" BorderBrush="{StaticResource AccentBrush}" BorderThickness="1" Opacity="0.95">
        <Grid>
            <!-- Particle Background Canvas -->
            <Canvas x:Name="ParticleCanvas" ClipToBounds="True"/>
            
            <!-- Blotic Logo in Center Background -->
            <Viewbox Width="450" Height="450" 
                     HorizontalAlignment="Center" 
                     VerticalAlignment="Center"
                     Opacity="0.70">
                <Image Source="Assets/blotic_logo.png" 
                       Stretch="Uniform">
                    <Image.Effect>
                        <DropShadowEffect Color="#4F9CF9" 
                                        BlurRadius="100" 
                                        ShadowDepth="0" 
                                        Opacity="0.8"/>
                    </Image.Effect>
                </Image>
            </Viewbox>
            
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <!-- Sidebar Navigation -->
                <Border Grid.Column="0" Background="#000000" BorderBrush="#1A1A1A" BorderThickness="0,0,1,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <!-- Logo Section -->
                        <StackPanel Grid.Row="0" Margin="0,20,0,30">
                            <Image Source="Assets/blotic_logo.png" 
                                   Width="48" 
                                   Height="48" 
                                   HorizontalAlignment="Center"/>
                        </StackPanel>
                        
                        <!-- Navigation Items -->
                        <StackPanel Grid.Row="1" Margin="0,20,0,0">
                            <!-- Home Button -->
                            <Button x:Name="HomeNavButton" Click="HomeNav_Click" 
                                    Background="{StaticResource PrimaryBrush}"
                                    BorderThickness="0"
                                    HorizontalAlignment="Stretch" 
                                    Padding="0"
                                    Margin="0,0,0,15"
                                    Height="80"
                                    Cursor="Hand"
                                    Tag="Active">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" 
                                                BorderThickness="0,0,3,0"
                                                BorderBrush="{StaticResource PrimaryBrush}"
                                                x:Name="HomeNavBorder">
                                            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                                <Viewbox Width="32" Height="32" Margin="0,0,0,8">
                                                    <Canvas Width="24" Height="24">
                                                        <Path Data="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" 
                                                              Fill="White"
                                                              x:Name="HomeNavIcon"/>
                                                    </Canvas>
                                                </Viewbox>
                                                <TextBlock Text="Home" 
                                                           FontSize="13" 
                                                           FontWeight="SemiBold" 
                                                           Foreground="White"
                                                           x:Name="HomeNavText"
                                                           HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="HomeNavBorder" Property="Background" Value="#1A1F2E"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            
                            <!-- My Games Button -->
                            <Button x:Name="MyGamesNavButton" Click="MyGamesNav_Click" 
                                    Background="Transparent"
                                    BorderThickness="0"
                                    HorizontalAlignment="Stretch" 
                                    Padding="0"
                                    Margin="0,0,0,15"
                                    Height="80"
                                    Cursor="Hand"
                                    Tag="Inactive">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" 
                                                BorderThickness="0,0,3,0"
                                                BorderBrush="Transparent"
                                                x:Name="NavBorder">
                                            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                                <Viewbox Width="32" Height="32" Margin="0,0,0,8">
                                                    <Canvas Width="24" Height="24">
                                                        <Path Data="M7.97,16L5,19C4.67,19.3 4.23,19.5 3.75,19.5A1.75,1.75 0 0,1 2,17.75V17.5L3,10.12C3.21,7.81 5.14,6 7.5,6H16.5C18.86,6 20.79,7.81 21,10.12L22,17.5V17.75A1.75,1.75 0 0,1 20.25,19.5C19.77,19.5 19.33,19.3 19,19L16.03,16H7.97M7,8V10H5V11H7V13H8V11H10V10H8V8H7M16.5,8.75A0.75,0.75 0 0,0 15.75,9.5A0.75,0.75 0 0,0 16.5,10.25A0.75,0.75 0 0,0 17.25,9.5A0.75,0.75 0 0,0 16.5,8.75M14.75,10.5A0.75,0.75 0 0,0 14,11.25A0.75,0.75 0 0,0 14.75,12A0.75,0.75 0 0,0 15.5,11.25A0.75,0.75 0 0,0 14.75,10.5M18.25,10.5A0.75,0.75 0 0,0 17.5,11.25A0.75,0.75 0 0,0 18.25,12A0.75,0.75 0 0,0 19,11.25A0.75,0.75 0 0,0 18.25,10.5M16.5,12.25A0.75,0.75 0 0,0 15.75,13A0.75,0.75 0 0,0 16.5,13.75A0.75,0.75 0 0,0 17.25,13A0.75,0.75 0 0,0 16.5,12.25Z" 
                                                              Fill="#8A8F98"
                                                              x:Name="NavIcon"/>
                                                    </Canvas>
                                                </Viewbox>
                                                <TextBlock Text="My Games" 
                                                           FontSize="13" 
                                                           FontWeight="Normal" 
                                                           Foreground="#8A8F98"
                                                           x:Name="NavText"
                                                           HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="NavBorder" Property="Background" Value="#1A1F2E"/>
                                                <Setter TargetName="NavIcon" Property="Fill" Value="White"/>
                                                <Setter TargetName="NavText" Property="Foreground" Value="White"/>
                                            </Trigger>
                                            <DataTrigger Binding="{Binding Tag, RelativeSource={RelativeSource Self}}" Value="Active">
                                                <Setter TargetName="NavBorder" Property="BorderBrush" Value="{StaticResource PrimaryBrush}"/>
                                                <Setter TargetName="NavIcon" Property="Fill" Value="White"/>
                                                <Setter TargetName="NavText" Property="Foreground" Value="White"/>
                                                <Setter TargetName="NavText" Property="FontWeight" Value="SemiBold"/>
                                            </DataTrigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            
                            <!-- Profile Button -->
                            <Button x:Name="ProfileNavButton" Click="ProfileNav_Click" 
                                    Background="Transparent"
                                    BorderThickness="0"
                                    HorizontalAlignment="Stretch" 
                                    Padding="0"
                                    Margin="0,0,0,15"
                                    Height="80"
                                    Cursor="Hand"
                                    Tag="Inactive">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" 
                                                BorderThickness="0,0,3,0"
                                                BorderBrush="Transparent"
                                                x:Name="ProfileNavBorder">
                                            <Grid VerticalAlignment="Center" HorizontalAlignment="Center">
                                                <StackPanel>
                                                    <Viewbox Width="32" Height="32" Margin="0,0,0,8">
                                                        <Canvas Width="24" Height="24">
                                                            <Path Data="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z" 
                                                                  Fill="#8A8F98"
                                                                  x:Name="ProfileNavIcon"/>
                                                        </Canvas>
                                                    </Viewbox>
                                                    <TextBlock Text="Profile" 
                                                               FontSize="13" 
                                                               FontWeight="Normal" 
                                                               Foreground="#8A8F98"
                                                               x:Name="ProfileNavText"
                                                               HorizontalAlignment="Center"/>
                                                </StackPanel>
                                                <!-- Game Count Badge -->
                                                <Border x:Name="GameCountBadge"
                                                        Background="{StaticResource AccentBrush}"
                                                        CornerRadius="10"
                                                        Padding="6,2"
                                                        HorizontalAlignment="Right"
                                                        VerticalAlignment="Top"
                                                        Margin="0,-5,-5,0"
                                                        Visibility="Collapsed">
                                                    <TextBlock x:Name="ProfileGameCount"
                                                               Text="0"
                                                               FontSize="10"
                                                               FontWeight="Bold"
                                                               Foreground="White"/>
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="ProfileNavBorder" Property="Background" Value="#1A1F2E"/>
                                                <Setter TargetName="ProfileNavIcon" Property="Fill" Value="White"/>
                                                <Setter TargetName="ProfileNavText" Property="Foreground" Value="White"/>
                                            </Trigger>
                                            <DataTrigger Binding="{Binding Tag, RelativeSource={RelativeSource Self}}" Value="Active">
                                                <Setter TargetName="ProfileNavBorder" Property="BorderBrush" Value="{StaticResource PrimaryBrush}"/>
                                                <Setter TargetName="ProfileNavIcon" Property="Fill" Value="White"/>
                                                <Setter TargetName="ProfileNavText" Property="Foreground" Value="White"/>
                                                <Setter TargetName="ProfileNavText" Property="FontWeight" Value="SemiBold"/>
                                            </DataTrigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- Main Content Area -->
                <Grid Grid.Column="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                <!-- Title Bar -->
                <Grid Grid.Row="0" Background="{StaticResource SurfaceBrush}" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown" Panel.ZIndex="1000">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Orientation="Horizontal" Margin="20,22" VerticalAlignment="Center">
                    <TextBlock Text="Blotic Arena" 
                               FontSize="28" 
                               FontWeight="Bold" 
                               Foreground="{StaticResource TextPrimaryBrush}"
                               VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,10,0">
                    <!-- Login/Profile Button -->
                    <Button x:Name="ProfileButton"
                            Width="160" 
                            Height="55" 
                            Background="Transparent"
                            BorderThickness="0"
                            BorderBrush="Transparent"
                            Click="ProfileButton_Click"
                            Cursor="Hand"
                            Margin="0,0,15,0"
                            VerticalAlignment="Center"
                            FocusVisualStyle="{x:Null}">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
                                <Setter Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="1" ScaleY="1"/>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="border"
                                                    Background="{TemplateBinding Background}"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    CornerRadius="8">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="border" Property="Background" Value="{StaticResource HoverBrush}"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <EventTrigger RoutedEvent="MouseEnter">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                                               To="1.05" Duration="0:0:0.2"/>
                                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                                               To="1.05" Duration="0:0:0.2"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                    <EventTrigger RoutedEvent="MouseLeave">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                                               To="1.0" Duration="0:0:0.2"/>
                                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                                               To="1.0" Duration="0:0:0.2"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                        <StackPanel Orientation="Horizontal">
                            <!-- Profile Avatar -->
                            <Border x:Name="ProfileButtonAvatar"
                                    Width="40"
                                    Height="40"
                                    CornerRadius="20"
                                    Background="{StaticResource PrimaryBrush}"
                                    Margin="0,0,8,0"
                                    ClipToBounds="True"
                                    Visibility="Collapsed">
                                <Grid>
                                    <TextBlock x:Name="ProfileButtonInitials"
                                               Text="U"
                                               FontSize="18"
                                               FontWeight="Bold"
                                               Foreground="White"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"/>
                                    <Ellipse Width="40" Height="40">
                                        <Ellipse.Fill>
                                            <ImageBrush x:Name="ProfileButtonImageBrush"
                                                        Stretch="UniformToFill"
                                                        AlignmentX="Center"
                                                        AlignmentY="Center"/>
                                        </Ellipse.Fill>
                                    </Ellipse>
                                </Grid>
                            </Border>
                            
                            <!-- Default Icon (when not logged in) -->
                            <Viewbox x:Name="ProfileButtonIcon" Width="24" Height="24" Margin="0,0,10,0">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z" 
                                          Fill="{StaticResource PrimaryBrush}"/>
                                </Canvas>
                            </Viewbox>
                            
                            <TextBlock x:Name="ProfileButtonText"
                                       Text="Login" 
                                       FontSize="18" 
                                       FontWeight="SemiBold" 
                                       Foreground="{StaticResource PrimaryBrush}"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                    
                    <!-- Minimize Button -->
                    <Button Width="45" 
                            Height="45" 
                            Background="Transparent"
                            BorderThickness="0"
                            Click="MinimizeButton_Click"
                            Cursor="Hand"
                            Margin="0"
                            FocusVisualStyle="{x:Null}">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}">
                                                <Viewbox Width="12" Height="12">
                                                    <Canvas Width="12" Height="12">
                                                        <Line X1="0" Y1="6" X2="12" Y2="6" Stroke="#8A8F98" StrokeThickness="1"/>
                                                    </Canvas>
                                                </Viewbox>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#20FFFFFF"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                    
                    <!-- Maximize Button -->
                    <Button Width="45" 
                            Height="45" 
                            Background="Transparent"
                            BorderThickness="0"
                            Click="MaximizeButton_Click"
                            Cursor="Hand"
                            Margin="0"
                            FocusVisualStyle="{x:Null}">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}">
                                                <Viewbox Width="12" Height="12">
                                                    <Canvas Width="12" Height="12">
                                                        <Rectangle Width="10" Height="10" Stroke="#8A8F98" StrokeThickness="1" Canvas.Left="1" Canvas.Top="1"/>
                                                    </Canvas>
                                                </Viewbox>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#20FFFFFF"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                    
                    <!-- Close Button -->
                    <Button Width="45" 
                            Height="45" 
                            Background="Transparent"
                            BorderThickness="0"
                            Click="CloseButton_Click"
                            Cursor="Hand"
                            Margin="0"
                            FocusVisualStyle="{x:Null}">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="border" Background="{TemplateBinding Background}">
                                                <Viewbox Width="12" Height="12">
                                                    <Canvas Width="12" Height="12">
                                                        <Path x:Name="closePath" Data="M 1,1 L 11,11 M 11,1 L 1,11" Stroke="#8A8F98" StrokeThickness="1.2"/>
                                                    </Canvas>
                                                </Viewbox>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="border" Property="Background" Value="#E81123"/>
                                                    <Setter TargetName="closePath" Property="Stroke" Value="White"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
            </Grid>

            <!-- Header Section -->
            <Grid Grid.Row="1" Margin="30,15,30,10">
                <StackPanel>
                    <TextBlock x:Name="PageTitle"
                               Text="HOME" 
                               FontSize="24" 
                               FontWeight="Bold" 
                               Foreground="White"
                               Margin="0,0,0,5"/>
                    <TextBlock x:Name="GameCountHeader"
                               Text="0 favorite games"
                               FontSize="13" 
                               Foreground="{StaticResource TextSecondaryBrush}"/>
                </StackPanel>
            </Grid>

            <!-- QR Code Full Screen Overlay -->
            <Grid x:Name="QRCodePanel" 
                  Grid.Column="0"
                  Grid.ColumnSpan="2"
                  Grid.Row="0" 
                  Grid.RowSpan="3"
                  Background="#0A0E14" 
                  Visibility="Collapsed"
                  Panel.ZIndex="999"
                  Opacity="0">
                <Grid.RenderTransform>
                    <ScaleTransform x:Name="QRScaleTransform" ScaleX="0.8" ScaleY="0.8"/>
                </Grid.RenderTransform>
                
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <!-- Title with glow effect -->
                    <TextBlock Text="SCAN TO LOGIN"
                               FontSize="48"
                               FontWeight="Black"
                               Foreground="{StaticResource AccentBrush}"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,40"
                               Opacity="0"
                               x:Name="QRTitleText">
                        <TextBlock.Effect>
                            <DropShadowEffect Color="#8B5CF6" 
                                              Direction="0" 
                                              ShadowDepth="0" 
                                              BlurRadius="40" 
                                              Opacity="0.8"/>
                        </TextBlock.Effect>
                    </TextBlock>
                    
                    <!-- QR Code with animated border -->
                    <Border Background="White"
                            CornerRadius="24"
                            Padding="30"
                            HorizontalAlignment="Center"
                            Opacity="0"
                            x:Name="QRBorder">
                        <Border.Effect>
                            <DropShadowEffect Color="#8B5CF6" 
                                              Direction="0" 
                                              ShadowDepth="0" 
                                              BlurRadius="60" 
                                              Opacity="0.6"/>
                        </Border.Effect>
                        <Border.RenderTransform>
                            <RotateTransform x:Name="QRRotateTransform" Angle="0" CenterX="180" CenterY="180"/>
                        </Border.RenderTransform>
                        
                        <Grid>
                            <Image x:Name="QRCodeImage"
                                   Width="360"
                                   Height="360"
                                   Stretch="Uniform"/>
                            
                            <!-- Blotic Logo in center of QR -->
                            <Border Width="80" 
                                    Height="80"
                                    Background="White"
                                    CornerRadius="12"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Padding="8">
                                <Image Source="Assets/blotic_logo.png" 
                                       Stretch="Uniform"/>
                            </Border>
                        </Grid>
                    </Border>
                    
                    <!-- Status text with pulse -->
                    <TextBlock x:Name="QRStatusText"
                               Text="Waiting for scan..."
                               FontSize="20"
                               FontWeight="SemiBold"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               HorizontalAlignment="Center"
                               Margin="0,40,0,0"
                               Opacity="0">
                        <TextBlock.Effect>
                            <DropShadowEffect Color="White" 
                                              Direction="0" 
                                              ShadowDepth="0" 
                                              BlurRadius="20" 
                                              Opacity="0.3"/>
                        </TextBlock.Effect>
                    </TextBlock>
                </StackPanel>
            </Grid>
            
            <!-- Profile Details Panel (Hidden by default) -->
            <Grid x:Name="ProfilePanel" Grid.Row="2" Visibility="Collapsed" Margin="40">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel HorizontalAlignment="Stretch">
                        <!-- Profile Header -->
                        <Border Background="{StaticResource SurfaceBrush}"
                                CornerRadius="12"
                                Padding="40"
                                Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Avatar -->
                                <Border Grid.Column="0"
                                        Width="120"
                                        Height="120"
                                        CornerRadius="60"
                                        Background="{StaticResource PrimaryBrush}"
                                        Margin="0,0,30,0"
                                        ClipToBounds="True">
                                    <Grid>
                                        <TextBlock x:Name="ProfileInitials"
                                                   Text="U"
                                                   FontSize="48"
                                                   FontWeight="Bold"
                                                   Foreground="White"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"/>
                                        <Ellipse Width="120" Height="120">
                                            <Ellipse.Fill>
                                                <ImageBrush x:Name="ProfileAvatarBrush"
                                                            Stretch="UniformToFill"
                                                            AlignmentX="Center"
                                                            AlignmentY="Center"/>
                                            </Ellipse.Fill>
                                        </Ellipse>
                                    </Grid>
                                </Border>
                                
                                <!-- User Info -->
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock x:Name="ProfileName"
                                               Text="User Name"
                                               FontSize="32"
                                               FontWeight="Bold"
                                               Foreground="{StaticResource TextPrimaryBrush}"
                                               Margin="0,0,0,8"/>
                                    <TextBlock x:Name="ProfileEmail"
                                               Text="user@example.com"
                                               FontSize="16"
                                               Foreground="{StaticResource TextSecondaryBrush}"
                                               Margin="0,0,0,4"/>
                                    <TextBlock x:Name="ProfilePhone"
                                               Text="+1234567890"
                                               FontSize="14"
                                               Foreground="{StaticResource TextSecondaryBrush}"/>
                                </StackPanel>
                                
                                <!-- Logout Button -->
                                <Button Grid.Column="2"
                                        x:Name="ProfileHeaderLogoutButton"
                                        Click="ProfileLogout_Click"
                                        Background="Transparent"
                                        Foreground="White"
                                        BorderBrush="#DC2626"
                                        BorderThickness="2"
                                        Padding="24,12"
                                        FontSize="14"
                                        FontWeight="Bold"
                                        Cursor="Hand"
                                        VerticalAlignment="Center"
                                        FocusVisualStyle="{x:Null}">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border x:Name="border"
                                                                Background="{TemplateBinding Background}"
                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                CornerRadius="10"
                                                                Padding="{TemplateBinding Padding}">
                                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                                <Border Width="28" Height="28"
                                                                        CornerRadius="14"
                                                                        Background="#DC2626"
                                                                        Margin="0,0,10,0">
                                                                    <TextBlock Text="⏻" 
                                                                               FontSize="18" 
                                                                               FontWeight="Bold"
                                                                               HorizontalAlignment="Center" 
                                                                               VerticalAlignment="Center"
                                                                               Margin="0,-2,0,0"/>
                                                                </Border>
                                                                <TextBlock x:Name="logoutText"
                                                                           Text="Logout" 
                                                                           FontSize="14" 
                                                                           FontWeight="Bold" 
                                                                           Foreground="#DC2626" 
                                                                           VerticalAlignment="Center"/>
                                                            </StackPanel>
                                                        </Border>
                                                        <ControlTemplate.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter TargetName="border" Property="Background" Value="#DC2626"/>
                                                                <Setter TargetName="border" Property="BorderBrush" Value="#DC2626"/>
                                                                <Setter TargetName="logoutText" Property="Foreground" Value="White"/>
                                                            </Trigger>
                                                        </ControlTemplate.Triggers>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </Grid>
                        </Border>
                        
                        <!-- Game Stats -->
                        <Border Background="{StaticResource SurfaceBrush}"
                                CornerRadius="12"
                                Padding="40"
                                Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Games Remaining -->
                                <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                    <TextBlock x:Name="GamesRemainingCount"
                                               Text="0"
                                               FontSize="64"
                                               FontWeight="Bold"
                                               Foreground="{StaticResource AccentBrush}"
                                               HorizontalAlignment="Center"/>
                                    <TextBlock Text="Games Remaining"
                                               FontSize="16"
                                               Foreground="{StaticResource TextSecondaryBrush}"
                                               HorizontalAlignment="Center"
                                               Margin="0,12,0,0"/>
                                </StackPanel>
                                
                                <!-- Total Played -->
                                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                    <TextBlock x:Name="TotalPlayedCount"
                                               Text="0"
                                               FontSize="64"
                                               FontWeight="Bold"
                                               Foreground="{StaticResource PrimaryBrush}"
                                               HorizontalAlignment="Center"/>
                                    <TextBlock Text="Total Played"
                                               FontSize="16"
                                               Foreground="{StaticResource TextSecondaryBrush}"
                                               HorizontalAlignment="Center"
                                               Margin="0,12,0,0"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                        
                    </StackPanel>
                </ScrollViewer>
            </Grid>
            
            <!-- Apps Grid -->
            <ScrollViewer x:Name="AppsScrollViewer" Grid.Row="2" 
                          VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Disabled"
                          Margin="20,0">
                <ItemsControl x:Name="AppsItemsControl">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Style="{StaticResource AppCard}"
                                    Width="180"
                                    MinHeight="240">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Favorite Badge -->
                                    <Border Grid.Row="0"
                                            Background="{StaticResource AccentBrush}"
                                            CornerRadius="4"
                                            Padding="8,4"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Top"
                                            Margin="0,8,8,0"
                                            Visibility="Collapsed"
                                            x:Name="FavoriteBadge">
                                        <TextBlock Text="★ HOME" 
                                                   Foreground="White" 
                                                   FontSize="10" 
                                                   FontWeight="Bold"/>
                                    </Border>

                                    <!-- App Icon -->
                                    <Grid Grid.Row="1" 
                                          Width="80" 
                                          Height="80"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          Margin="0,10,0,0">
                                        <!-- Real Icon Image -->
                                        <Image Source="{Binding IconImage}" 
                                               MaxWidth="70" 
                                               MaxHeight="70"
                                               Stretch="Uniform"
                                               RenderOptions.BitmapScalingMode="HighQuality">
                                            <Image.Style>
                                                <Style TargetType="Image">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IconImage}" Value="{x:Null}">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Image.Style>
                                        </Image>
                                        <!-- Fallback Emoji Icon -->
                                        <Viewbox>
                                            <TextBlock Text="{Binding Icon}" FontSize="64">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IconImage}" Value="{x:Null}">
                                                                <Setter Property="Visibility" Value="Visible"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Viewbox>
                                    </Grid>

                                    <!-- App Name -->
                                    <TextBlock Grid.Row="2"
                                               Text="{Binding Name}"
                                               Foreground="White"
                                               FontSize="14"
                                               FontWeight="SemiBold"
                                               TextAlignment="Center"
                                               TextWrapping="Wrap"
                                               Margin="0,10,0,5"
                                               MaxHeight="40"/>

                                    <!-- App Type -->
                                    <TextBlock Grid.Row="3"
                                               Text="{Binding Type}"
                                               Foreground="{StaticResource TextSecondaryBrush}"
                                               FontSize="10"
                                               TextAlignment="Center"
                                               Margin="0,0,0,8"/>

                                    <!-- Play Button -->
                                    <Button Grid.Row="4"
                                            Background="{StaticResource PrimaryBrush}"
                                            Foreground="White"
                                            BorderThickness="0"
                                            Padding="20,10"
                                            Cursor="Hand"
                                            Click="PlayButton_Click"
                                            Tag="{Binding LaunchCommand}"
                                            HorizontalAlignment="Stretch"
                                            Margin="10,5,10,10">
                                        <Button.Template>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="6"
                                                        Padding="{TemplateBinding Padding}">
                                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                        <TextBlock Text="▶" FontSize="12" Margin="0,0,6,0" FontWeight="Bold"/>
                                                        <TextBlock Text="PLAY" FontSize="12" FontWeight="Bold"/>
                                                    </StackPanel>
                                                </Border>
                                            </ControlTemplate>
                                        </Button.Template>
                                        <Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="#6B9EFF"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                    </Button>
                                    
                                    <!-- Add to Home Button (only visible on My Games page) -->
                                    <Button Grid.Row="5"
                                            x:Name="AddToHomeButton"
                                            Content="+ Add to Home"
                                            Click="FavoriteButton_Click"
                                            Tag="{Binding Name}"
                                            Background="Transparent"
                                            Foreground="{StaticResource AccentBrush}"
                                            BorderBrush="{StaticResource AccentBrush}"
                                            BorderThickness="1"
                                            Padding="10,6"
                                            Cursor="Hand"
                                            HorizontalAlignment="Stretch"
                                            Margin="10,0,10,10"
                                            FontSize="11"
                                            FontWeight="SemiBold"
                                            Visibility="Collapsed">
                                        <Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Background" Value="Transparent"/>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="#1ACC75DB"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                    </Button>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>

                </Grid>
            </Grid>
            
            <!-- Welcome Animation Overlay -->
            <Grid x:Name="WelcomeOverlay" 
                  Background="#DD0A0E14" 
                  Visibility="Collapsed"
                  Panel.ZIndex="1000">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <TextBlock x:Name="WelcomeText"
                               Text="WELCOME"
                               FontSize="48"
                               FontWeight="Bold"
                               Foreground="White"
                               HorizontalAlignment="Center"
                               Opacity="0"/>
                    <TextBlock x:Name="UsernameText"
                               Text="Username"
                               FontSize="72"
                               FontWeight="Black"
                               Foreground="{StaticResource AccentBrush}"
                               HorizontalAlignment="Center"
                               Margin="0,20,0,0"
                               Opacity="0"/>
                </StackPanel>
            </Grid>
            
            <!-- Toast Notification Container -->
            <StackPanel x:Name="ToastContainer"
                        VerticalAlignment="Top"
                        HorizontalAlignment="Right"
                        Margin="0,80,20,0"
                        Panel.ZIndex="2000"/>
        </Grid>
    </Border>
</Window>
